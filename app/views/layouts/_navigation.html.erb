<nav class="navbar navbar-default">
  <div class="container">

    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#pinch-nav">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">Pinch</a>
      <% if logged_in? %>
        <form action="/goals/search" class="form-inline navbar-right nav-search" role="search" method: "get">
          <div class="form-group">
            <input type="text" name="search_term" class="form-control" placeholder="Search goals">
            <button type="submit" class="btn btn-default btn-search">Search</button>
          </div>
        </form>
      <% end %>
    </div>

    <div class="collapse navbar-collapse navbar-right" id="pinch-nav">

      <ul class="nav navbar-nav">
        <% if logged_in? %>
          <li>
            <%= link_to 'Dashboard', dashboard_user_path(current_user) %>
          </li>
          <li>
            <%= link_to 'New Goal', new_goal_path %>
          </li>
          <li>
            <%= link_to 'New Category', new_category_path if current_user.admin? %>
          </li>
          <li>
            <%= link_to 'Browse Goals', goals_path %>
          </li>
          <li class="dropdown">
            <%= link_to '#', class: 'dropdown-toggle', 'data-toggle' => 'dropdown', 'role' => 'button', 'aria-expanded' => 'false' do %>
              <img src=<%= current_user.gravatar_url %> class="img-responsive img-circle nav-gravatar">
              <% if current_user.new_notification_count.zero? %>
                <%= current_user.username %>
              <% else %>
                <%= current_user.username %>  <span class="glyphicon glyphicon-bell"></span>
              <% end %>
              <span class="caret"></span>
            <% end %>
            <ul class="dropdown-menu" role="menu">
              <li>
                <%= link_to notifications_path do %>
                  <span class="glyphicon glyphicon-envelope"></span>
                  <%= current_user.new_notification_count.zero? ? "Notifications" : "Notifications (#{current_user.new_notification_count})" %>
                <% end %>
              </li>
              <li>
                <%= link_to user_path(current_user) do %>
                  <span class="glyphicon glyphicon-user"></span>
                  View Profile
                <% end %>
              </li>
              <li>
                <%= link_to edit_user_path(current_user) do %>
                  <span class="glyphicon glyphicon-pencil"></span>
                  Edit Profile
                <% end %>
              </li>
              <li>
                <%= link_to logout_path do %>
                  <span class="glyphicon glyphicon-circle-arrow-left"></span> 
                  Logout
                <% end %>
              </li>
            </ul>
          </li>
        <% else %>
          <button type="button" class="btn btn-default btn-login navbar-btn navbar-right">
            <%= link_to 'Log in', login_path %>
          </button>
        <% end %>
      </ul>


    </div>
  </div>
</nav>